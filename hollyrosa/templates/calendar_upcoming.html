<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!--
Copyright 2010, 2011, 2012 Martin Eliasson

This file is part of Hollyrosa

Hollyrosa is free software: you can redistribute it and/or modify
it under the terms of the GNU Affero General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

Hollyrosa is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU Affero General Public License for more details.

You should have received a copy of the GNU Affero General Public License
along with Hollyrosa.  If not, see <http://www.gnu.org/licenses/>.

-->

<?python
import datetime
def makeDate(s):
    return datetime.datetime.strptime(s, '%Y-%m-%d')

?>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:py="http://genshi.edgewall.org/" xmlns:xi="http://www.w3.org/2001/XInclude">

  <xi:include href="master.html" />

<head>
  <meta content="text/html; charset=UTF-8" http-equiv="content-type" py:replace="''"/>
  <title>Hollyrosa - Calendar Upcoming</title>
</head>

<body>
    <h2>Calendar Upcoming</h2>
    <table class="data">
        <tr py:for="booking_day in booking_days" style="${['','background:#fdd;'][6==makeDate(booking_day['date']).weekday()]}" class="calendar_overview">
            <td class="data info">
               <div style="background-color:#ddd; padding-top:0.5em;padding-bottom:0.5em; font-size:150%;"><a style="font-weight:bold;" href="${tg.url('/booking/day',day_id=str(booking_day['_id']))}">${makeDate(booking_day['date']).strftime('%A %d %b')}</a></div> 
                <ul class="any_menu context_inline_menu">
                    <li><a href="${url('/visiting_group/view_at_date', at_date=booking_day['date'])}">Visiting groups this day</a></li>
                    <li><a href="${url('/booking/fladan_day', ag='Fladan', day=booking_day['date'])}">Fladan schema</a></li>
                    <li><a href="${url('/booking/fladan_day', ag='Trapper', day=booking_day['date'])}">Trapper schema</a></li>
                    <li><a href="${url('/booking/fladan_day', day=booking_day['date'])}">All Day schema</a></li>
                </ul> 

            
            <div style="float:left;">${HTML(booking_day.note)}</div>
              <div style="padding:1em; border: 1px dashed #ccc; float:right;"> 
              <h3>arrives:</h3>
              <ul> 
                <li py:for="g in group_info[str(booking_day['date'])]['arrives']"><a href="${tg.url('/visiting_group/show_visiting_group', id=g['_id'])}">${g.name}</a></li>
              </ul> 

              <h3>leaves:</h3> 
              <ul> 
                <li py:for="g in group_info[str(booking_day['date'])]['leaves']"><a href="${tg.url('/visiting_group/show_visiting_group', id=g['_id'])}">${g.name}</a></li>
              </ul>

              <h3>stays:</h3>
              <ul> 
                <li py:for="g in group_info[str(booking_day['date'])]['stays']"  py:if="g.name not in ['N/A','Program I','Program II','Fladan I','Fladan II','Konf I','Konf II']"><a href="${tg.url('/visiting_group/show_visiting_group', id=g['_id'])}">${g['name']}</a></li>
              </ul> 
              </div>
            </td>
        </tr>
        
    </table>
</body>
</html>
